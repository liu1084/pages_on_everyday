# MySQL 数据类型



- :clown_face: VARCHAR 

在 MySQL 中， `VARCHAR` 是可变长度的字符串类型，这与 `CHAR` 数据类型有所不同。当一个列的类型定义为 `VARCHAR` 类型后，列中的内容的长度就是内容本身的长度（字符数）。

定义数据库表结构的时候，可以定义字段的类型为`varchar`类型，如果省略长度，默认长度是255。

注意：

1.  长度是指可以存储的字符的个数。

2.  VARCHAR类型的长度限制：65535字节。

    （为什么用字节，而不是字符？跟编码有关系：latin1 -1， utf8 - 3, utf8mb4 - 4）

3.   MySQL 存储 `VARCHAR` 数值时，会将最前的 1 或者 2 个字节存储为实际字符串内容的长度。如果列的值少于 255 个字节，则长度前缀为 1 个字节，否则为 2 个字节。 

4.  在 MySQL 中，除了 `TEXT` 和 `BLOB` 列， 行大小限制为 `65535` 个字节。那么 `VARCHAR` 最多长度为 `65535` 个字节。此外，一个 `VARCHAR` 列中能够存储多少个字符还和数据库使用的[字符集](https://www.sjkjc.com/mysql/character-set/)有关。

5.  当varchar中的允许为NULL的时候，最大字节数再减去1；

 

1.  语法

```sql
create table t1_varchar (
	field_name varchar(3) not null default ''
);

## (65535-2)/4 = 16383
create table t2_varchar (
    field_name varchar(16383) not null default ''
);
## 正例
insert into t2_varchar(field_name) values('16383');

## 错例
insert into t2_varchar(field_name) values(NULL);
## [23000][1048] Column 'field_name' cannot be null
## 原因:t2.field_name不允许为NULL，插入失败


## (65535-2-1) /4 = 16383
create table t3_varchar (
    field_name varchar(16383) null
);

## 正例
insert into t3_varchar(field_name) values('16383');
insert into t3_varchar(field_name) values(NULL);
```



1.  示例

```sql
## 错例
CREATE TABLE test_varchar_latin1 (v VARCHAR(65535))
CHARACTER SET 'latin1';

## [42000][1118] Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs
## 原因: 65535 - 2 - 1 = 65532

## 错例
CREATE TABLE test_varchar_utf8 (v VARCHAR(65535))
CHARACTER SET 'utf8';
## [42000][1074] Column length too big for column 'v' (max = 21845); use BLOB or TEXT instead
## 原因: 65532 - 2 - 1 除以 3 = 21844

## 错例
CREATE TABLE test_varchar_utf8mb4 (v VARCHAR(65535))
CHARACTER SET 'utf8mb4';
## [42000][1074] Column length too big for column 'v' (max = 16383); use BLOB or TEXT instead
## 原因:  65532 - 2 - 1 除以 4 = 16383
```



1.  特点

varchar(这列存储的最大字符数).

如果超过最大字符数的情况,分2种情形处理:

-   截断后插入,产生警告

-   抛异常,无法完成插入

举例说明:

```sql
create table sakila.test_varchar(
    id   bigint auto_increment primary key,
    name varchar(3) default '' not null
);

## 正例
insert into test_varchar(name) values
('aaa'),
('中中中');

2 rows affected in 4 ms

## 警告
insert into test_varchar(name) values
('bbb  '), #两个空格
('中中中    ') #3个空格; 

[2023-07-07 17:41:12] [01000][1265] Data truncated for column 'name' at row 1
[2023-07-07 17:41:12] [01000][1265] Data truncated for column 'name' at row 2
[2023-07-07 17:41:12] 2 rows affected in 4 ms

## 异常
insert into test_varchar(name) values
('bbba');

#[22001][1406] Data truncation: Data too long for column 'name' at row 1

## 查询
select * from test_varchar;
```

![image-20230707174344402](imgs/image-20230707174344402.png)



- :hear_no_evil: CHAR

 在 MySQL 中， `CHAR` 是固定长度的字符串类型，这与 `VARCHAR` 数据类型有所不同。当一个列的类型定义为 `CHAR` 类型后，列中的内容的长度就是字段定义的长度（字符数）。 

1.  语法

```sql
create table test_char (
    id bigint(20) auto_increment primary key ,
    name char(3) not null default ''
);

insert into test_char (name)
values ('1');

select length(name) from test_char;

```

![image-20230707175919265](imgs/image-20230707175919265.png)

这里：

-   `length` 是一个数值，它指示了此列的字符数。此例定义为3,表示最多可以容纳3个字符.
-   `length` 可以是 `0` 到 `255` 之间的任何值。
-   如果我们不指定此值，则默认值是 `1`。也就是说 `CHAR` 等同于 `CHAR(1)`。



```sql
insert into test_char (name)
values ('123');
select id, name from test_char;
```

![image-20230707180125661](imgs/image-20230707180125661.png)

```sql
##　反例
insert into test_char(name)
values('1234');

## [22001][1406] Data truncation: Data too long for column 'name' at row 1

```

2.  特点:

-   写入 `CHAR` 列中的字符串的长度小于指定的字符长度，MySQL 会在源字符串后填充空格一直到指定的长度。当您读取 `CHAR` 列中的值时，MySQL 会删除后面的空格。

-   由于 `CHAR` 数据类型采用固定的长度进行存储，因此 `CHAR` 的性能要比 `VARCHAR` 更好。
-   由于读取数据的时候,无论这些空格是自动补齐的还是原来数据固有的,会自动删除尾部的空格,当一个 `CHAR` 列为唯一列时这个可能会产生问题.





- :card_index_dividers: INT



- DECIMAL
- BIT
- DATE
- DATETIME
- YEAR
- ENUM